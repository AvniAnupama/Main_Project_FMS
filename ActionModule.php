<?php require_once("../config/db_connect.php");$obj=new db_connect;require_once("../functions/common_functions.php");$table_name="tbl_menu";$hasEntry=$obj->select_any_one($table_name,"1");$newEntry=!$hasEntry;if(isset($_REQUEST['module_item'])&&isset($_REQUEST['module_comments'])){$_REQUEST['module_item']=strtolower($_REQUEST['module_item']);if($newEntry){$prevdeatils=[];array_push($prevdeatils,$_REQUEST);$updatable['deatils']=json_encode($prevdeatils);$result['status']=!!$obj->inserttbl($updatable,$table_name);}else{$prevdeatils=json_decode($hasEntry['deatils']);$prevdeatils=is_null($prevdeatils)?[]:$prevdeatils;array_push($prevdeatils,$_REQUEST);$updatable="deatils = '".json_encode($prevdeatils)."'";$result['status']=!!$obj->updatetbl_special($updatable,$table_name,"1");}if($result['status']==1){CreateFolderWithFiles($_REQUEST['module_item']);echo count($prevdeatils);}else{echo 0;}}if(isset($_REQUEST['index'])){$result['status']=1;$index=$_REQUEST['index'];$prevdeatils=json_decode($hasEntry['deatils']);$prevdeatils=is_null($prevdeatils)?[]:$prevdeatils;if($index>=0&&$index<count($prevdeatils)){$deletedArray=array_splice($prevdeatils,$index,1);$updatable="deatils = '".json_encode($prevdeatils)."'";$result['status']=!!$obj->updatetbl_special($updatable,$table_name,"1");}else{$result['status']=0;}if($result['status']==1){$item=$deletedArray[0]->module_item;if($item!=''){require_once("../functions/page_functions.php");$index=$item;$result['status']=0;$table_name="tbl_pages";$hasEntry=$obj->select_any_one($table_name,"module='".$item."'");$newEntry=!$hasEntry;if($newEntry){}else{$prevdeatils=json_decode($hasEntry['pages']);$prevdeatils=is_null($prevdeatils)?[]:$prevdeatils;for($index=0;$index<count($prevdeatils);$index++){$deletedArray=array_splice($prevdeatils,$index,1);$updatable="pages = '".json_encode($prevdeatils)."'";$result['status']=!!$obj->updatetbl_special($updatable,$table_name,"module='".$item."'");if($result['status']==1){$dataArray=[];$PageDataForName=json_decode($hasEntry['pages'],true);array_push($dataArray,$deletedArray);$arrayOfDataToSend=json_decode(json_encode($dataArray),true);RemoveFilesFromPages($hasEntry['module'],$PageDataForName[$index]['page_name'],$arrayOfDataToSend,$obj);}}}$obj->tbl_delete("tbl_pages","module='".$item."'");}DeleteFolderWithFiles($item);echo 1;}} ?>